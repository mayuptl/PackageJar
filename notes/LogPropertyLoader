package core.logging;

import java.io.IOException;
import java.io.InputStream;
import java.util.Properties;

public class LogPropertyLoader {
    static {
        // This static block runs once when the class is loaded, ensuring
        // System Properties are set before Log4j initializes.
        try (InputStream input = LogPropertyLoader.class.getClassLoader().getResourceAsStream("log4j2.properties")) {
            if (input == null) {
                System.err.println("FATAL: Cannot find log4j2.properties on the classpath.");
            } else {
                Properties prop = new Properties();
                prop.load(input);

                // Set properties as System Properties so Log4j's 'sys:' lookup can find them
                System.setProperty("log4j2.logDir", prop.getProperty("log4j2.logDir"));
                System.setProperty("log4j2.fileName", prop.getProperty("log4j2.fileName"));

                // Optional: Print confirmation
                System.out.println("System Property Injected: log4j2.logDir = " + System.getProperty("log4j2.logDir"));
            }
        } catch (IOException ex) {
            ex.printStackTrace();
        }
    }
}